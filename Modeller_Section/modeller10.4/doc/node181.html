<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2018.2 (Released May 16, 2018) -->
<HTML>
<HEAD>
<TITLE>Model.read() &mdash; read coordinates for MODEL</TITLE>
<META NAME="description" CONTENT="Model.read() &mdash; read coordinates for MODEL">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018.2">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="manual.css">
<LINK REL="STYLESHEET" HREF="pygments.css">

<LINK REL="next" HREF="node182.html">
<LINK REL="previous" HREF="node180.html">
<LINK REL="up" HREF="node166.html">
<LINK REL="next" HREF="node182.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html4559"
  HREF="node182.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html4553"
  HREF="node166.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html4547"
  HREF="node180.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html4555"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html4557"
  HREF="node517.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html4560"
  HREF="node182.html">Model.build_sequence()   build</A>
<B> Up:</B> <A NAME="tex2html4554"
  HREF="node166.html">The Model class: handling</A>
<B> Previous:</B> <A NAME="tex2html4548"
  HREF="node180.html">Model.loops()   return</A>
 &nbsp; <B>  <A NAME="tex2html4556"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html4558"
  HREF="node517.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION0011615000000000000000">
Model.read() &mdash; read coordinates for MODEL</A>
</H2> <A NAME="14880"></A><A NAME="CMD:Model.read"></A><A NAME="14883"></A><TT>read(file, model_format='PDB_OR_MMCIF', model_segment=('FIRST:@', 'LAST:'), io=None, keep_disulfides=False)</TT>
<BR><A NAME="13817"></A>
<A NAME="13818"></A>
<BLOCKQUOTE>
This command reads the atomic coordinates, atom 
names, residue names, residue numbers<A NAME="tex2html103"
  HREF="footnode.html#foot14887"><SUP><SPAN CLASS="arabic">6</SPAN>.<SPAN CLASS="arabic">1</SPAN></SUP></A>, isotropic temperature factors
and segment specifications for MODEL, assigns residue types, and defines
the dihedral angles listed in the <TT>$RESDIH_LIB</TT> library.
For <TT>CHARMM</TT> and <TT>UHBD</TT> file formats, it also reads the atomic 
charges. However, it does not assign C<SMALL>HARMM</SMALL> and M<SMALL>ODELLER</SMALL> atom types, 
internal coordinates, charges (in the case of the <TT>'PDB'</TT> or <TT>'MMCIF'</TT> formats),
or patches (such as disulfides); to make these assignments, which are
necessary for almost all energy commands, use <B><A HREF="node185.html#CMD:Model.generatetopology">Model.generate_topology()</A></B><A NAME="14951"></A>. 
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><I CLASS="sans">file</I><A NAME="14956"></A> can be a filename or a readable file handle (see <B><A HREF="node457.html#CMD:modfile.File">modfile.File()</A></B><A NAME="14961"></A>).
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>The <TT>'PDB_OR_MMCIF'</TT> file format (the default) will read an mmCIF file
if the filename ends in <TT>'.cif'</TT>; otherwise it will read a PDB file.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><A NAME="14898"></A>The PDB residue type <TT>'HIS'</TT> is
assigned the
C<SMALL>HARMM</SMALL> residue type <TT>'HSD'</TT>, which is the neutral His with H on ND1.
The PDB types <TT>'ASP'</TT> and <TT>'GLU'</TT> are assigned the corresponding charged
C<SMALL>HARMM</SMALL> residue types, as are <TT>'LYS'</TT> and <TT>'ARG'</TT>. These conventions
are relevant only if Coulomb<A NAME="14975"></A> terms and/or hydrogens are used.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><A NAME="14905"></A><A NAME="14906"></A>
Certain noncanonical residues (such as MSE)
are automatically mapped to their closest canonical types by default; see
<I CLASS="sans"><A HREF="node150.html#MEMB:IOData.convertmodres">IOData.convert_modres</A></I><A NAME="14977"></A> for more details.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><I CLASS="sans">model_segment</I><A NAME="14982"></A> sets the beginning and ending residue identifiers 
for the contiguous sequence of residues to be read from the PDB or mmCIF file 
(this option does not work yet for the other file formats). The format 
of residue identifiers is described in Section&nbsp;<A HREF="node501.html#alignmentformat">B.1</A>. 
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><I CLASS="sans">keep_disulfides</I><A NAME="14985"></A>, if set to <TT>True</TT>, will preserve any disulfide
information already stored in the model. (The default is <TT>False</TT>, which
discards it.) This should only be used if the model being read in is guaranteed
to have the same sequence and atom ordering as the model in memory. This is
primarily used by the <TT>AutoModel</TT> class to copy <TT>SSBOND</TT> records
from the initial model (<TT>.ini</TT> file) to final output models.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>Note that this command reads in the model file directly, and does no special
handling to ensure the file is suitable for energy evaluations (<EM>e.g.</EM>, that it
has no missing atoms). If you want to read in a PDB file from PDB or generated
from an experiment or some other program, it is recommended that you use the
<B><A HREF="node460.html#CMD:completepdb">complete_pdb()</A></B><A NAME="14995"></A> script instead.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>For PDB or mmCIF files with alternate locations (characters in column 17
of PDB ATOM or HETATM records; <TT>'_atom_site.label_alt_id'</TT> in mmCIF),
M<SMALL>ODELLER</SMALL> reads only the first alternate location encountered
for each residue. (This differs from older versions of M<SMALL>ODELLER</SMALL>, which would
read only alternate locations marked with A or 1.)
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>For PDB files that contain multiple models (each starting with a <TT>'MODEL'</TT>
record and ending with an <TT>'ENDMDL'</TT> record), only the first model is read.
For mmCIF files, only models in the first <TT>'data_'</TT> block and with
<TT>'_atom_site.pdbx_PDB_model_num'</TT> equal to 1 are read.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>M<SMALL>ODELLER</SMALL> understands
<A NAME="tex2html104"
  HREF="http://cci.lbl.gov/hybrid_36/">hybrid-36</A>
notation, so
can read PDB files containing residues numbered 10,000 or higher, or
2-character chain names. See <I CLASS="sans"><A HREF="node151.html#MEMB:IOData.hybrid36">IOData.hybrid36</A></I><A NAME="15011"></A> and
<I CLASS="sans"><A HREF="node152.html#MEMB:IOData.twocharchain">IOData.two_char_chain</A></I><A NAME="15016"></A>.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>The model's R value is read from appropriately formatted PDB REMARKs or the
mmCIF <TT>'_refine'</TT> or <TT>'_pdbx_refine'</TT> categories and is
available as <I CLASS="sans"><A HREF="node330.html#MEMB:Sequence.rfactor">Sequence.rfactor</A></I><A NAME="15023"></A>. The first valid R value (not free R) found in
the PDB file is used.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>Some M<SMALL>ODELLER</SMALL>-specific REMARKs are also read from PDB files if they are
present. See <B><A HREF="node183.html#CMD:Model.write">Model.write()</A></B><A NAME="15030"></A> for a list of such REMARKs. The same information
is read from mmCIF files from M<SMALL>ODELLER</SMALL>-specific categories.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>Certain residues (<EM>e.g.</EM>, waters or HETATM records) can be skipped when reading
the file, and some modified residues are automatically converted to the
nearest equivalent standard amino acids; see <B><A HREF="node146.html#CMD:IOData">IOData()</A></B><A NAME="15038"></A>.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>This command can raise a <TT>FileFormatError</TT><A NAME="15043"></A> if the atom file format is
invalid.

</BLOCKQUOTE>

<P>

  <DL>
<DT><STRONG>Example: <A NAME="tex2html105"
  HREF="../examples/commands/read_model.py">examples/commands/read_model.py</A></STRONG></DT>
<DD> <BR>  <div class="pygments"><pre><span></span><span class="c1"># Example for: Model.read(), Model.write()</span>

<span class="c1"># This will read a PDB file and write both CHARMM and mmCIF atom files without</span>
<span class="c1"># atomic charges or radii. For assigning charges and radii, see the</span>
<span class="c1"># all_hydrogen.py script.</span>

<span class="kn">from</span> <span class="nn">modeller</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">Environ</span><span class="p">()</span>
<span class="n">env</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">atom_files_directory</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;../atom_files&#39;</span><span class="p">]</span>

<span class="n">mdl</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="n">mdl</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="s1">&#39;1fas&#39;</span><span class="p">)</span>
<span class="n">mdl</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="s1">&#39;1fas.crd&#39;</span><span class="p">,</span> <span class="n">model_format</span><span class="o">=</span><span class="s1">&#39;CHARMM&#39;</span><span class="p">)</span>
<span class="n">mdl</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="s1">&#39;1fas.cif&#39;</span><span class="p">,</span> <span class="n">model_format</span><span class="o">=</span><span class="s1">&#39;MMCIF&#39;</span><span class="p">)</span>
</pre></div>
  
</DD>
</DL>  <BR>
<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html4559"
  HREF="node182.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html4553"
  HREF="node166.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html4547"
  HREF="node180.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html4555"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html4557"
  HREF="node517.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html4560"
  HREF="node182.html">Model.build_sequence()   build</A>
<B> Up:</B> <A NAME="tex2html4554"
  HREF="node166.html">The Model class: handling</A>
<B> Previous:</B> <A NAME="tex2html4548"
  HREF="node180.html">Model.loops()   return</A>
 &nbsp; <B>  <A NAME="tex2html4556"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html4558"
  HREF="node517.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
